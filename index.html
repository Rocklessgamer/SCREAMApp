<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scouting PASS 2024</title>
    <style>
        /* ... (keep all existing styles) ... */
    </style>
</head>
<body>
    <h1 id="page-title">Scouting PASS 2024</h1>
    <form id="scouting-form"></form>

    <script>
        var config_data = `
        {
          "dataFormat": "tsv",
          "title": "Scouting PASS 2024",
          "page_title": "Crescendo",
          "checkboxAs": "10",
          "prematch": [
            { "name": "Scouter Initials",
              "code": "s",
              "type": "scouter",
              "size": 5,
              "maxSize": 5,
              "required": "true"
            },
            { "name": "Match #",
              "code": "m",
              "type": "match",
              "min": 1,
              "max": 150,
              "required": "true"
            },
            { "name": "Robot",
              "code": "r",
              "type": "robot",
              "choices": {
                "r1": "Red-1",
                "b1": "Blue-1",
                "r2": "Red-2",
                "b2": "Blue-2",
                "r3": "Red-3",
                "b3": "Blue-3"
              },
              "required":"true"
            },
            { "name": "Team #",
              "code": "t",
              "type": "team",
              "min": 1,
              "max": 99999
            }
          ],
          "auton": [
            { "name": "Leave Starting Zone",
              "code": "al",
              "type": "bool"
            },
            { "name": "Amp Scores",
              "code": "aas",
              "type": "counter"
            },
            { "name": "Speaker Scores",
              "code": "ass",
              "type": "counter"
            }
          ],
          "teleop": [
            { "name": "Amp Scores",
              "code": "tas",
              "type": "counter"
            },
            { "name": "Speaker Scores",
              "code": "tss",
              "type": "counter"
            },
            { "name": "Times Amplified",
              "code": "tta",
              "type": "counter"
            },
            { "name": "Pickup From",
              "code": "tpu",
              "type": "radio",
              "choices": {
                "s": "Source",
                "f": "Floor",
                "b": "Both",
                "x": "Not Attempted"
              },
              "defaultValue": "x"
            }
          ],
          "endgame": [
            { "name": "Final Status",
              "code": "fs",
              "type":"radio",
              "choices": {
                "p": "Parked",
                "o": "Onstage",
                "s": "Onstage (Spotlit)",
                "h": "Harmony",
                "a": "Attempted but failed",
                "x": "Not attempted"
              },
              "defaultValue": "x"
            },
            { "name": "Note in Trap",
              "code": "nit",
              "type": "bool"
            }
          ],
          "postmatch": [
            { "name": "Driver Skill",
              "code": "ds",
              "type": "radio",
              "choices": {
                "n": "Not Effective",
                "a": "Average",
                "v": "Very Effective",
                "x": "Not Observed"
              },
              "defaultValue": "x"
            },
            { "name": "Defense Rating",
              "code": "dr",
              "type": "radio",
              "choices": {
                "b": "Below Average",
                "a": "Average",
                "g": "Good",
                "e": "Excellent",
                "x": "Did not play defense"
              },
              "defaultValue": "x"
            },
            { "name": "Speed Rating",
              "code": "sr",
              "type": "radio",
              "choices": {
                "1": "1 (slow)",
                "2": "2",
                "3": "3",
                "4": "4",
                "5": "5 (fast)"
              },
              "defaultValue":"3"
            },
            { "name": "Died/Immobilized",
              "code": "die",
              "type": "bool"
            },
            { "name": "Tippy (almost tipped over)",
              "code": "tip",
              "type": "bool"
            },
            { "name": "Dropped Notes (>2)",
              "code": "dn",
              "type": "bool"
            },
            { "name": "Make good alliance partner?",
              "tooltip": "Would you want this robot on your alliance in eliminations?",
              "code": "all",
              "type": "bool"
            },
            { "name": "Comments",
              "code": "co",
              "type": "text",
              "size": 15,
              "maxSize": 55
            }
          ]
        }`;

        const config = JSON.parse(config_data);
        const form = document.getElementById('scouting-form');

        document.getElementById('page-title').textContent = config.page_title;

        // ... (keep all existing JavaScript code for form creation) ...

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script>
      // Modified form submission handler
      form.onsubmit = (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        let output = '';
        let values = [];
        
        // Collect all form data
        for (let [key, value] of formData.entries()) {
          values.push(value);
        }
        
        // Join all values with tabs
        output = values.join('\t');
        
        // Clear existing QR code
        const existingQR = document.getElementById('qrcode');
        if (existingQR) {
          existingQR.innerHTML = '';
        } else {
          // Create a container for the QR code if it doesn't exist
          const qrContainer = document.createElement('div');
          qrContainer.id = 'qrcode';
          document.body.appendChild(qrContainer);
        }
    
        // Generate the new QR code
        new QRCode(document.getElementById("qrcode"), {
          text: output,
          width: 256,
          height: 256
        });
    
        alert('Form submitted! QR Code updated below. Scan and copy the data into Google Sheets.');
      };
    </script>
</body>
</html>